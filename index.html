<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedUpdates - Ù…Ù†ØµØ© Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø·Ø¨ÙŠØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</title>
    <meta name="description" content="Ø£Ø­Ø¯Ø« Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ÙˆØ§Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©">
    <meta name="keywords" content="Ø·Ø¨ÙŠ, ØµØ­Ø©, Ø·Ø¨, Ø£Ø¨Ø­Ø§Ø«, Ù…Ù‚Ø§Ù„Ø§Øª Ø·Ø¨ÙŠØ©">
    <meta name="author" content="MedUpdates">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* ========== RESET & BASE ========== */
        :root {
            --primary: #0066ff;
            --primary-dark: #0052cc;
            --secondary: #64748b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1e293b;
            --light: #f5f8fb;
            --gray: #e2e8f0;
            --dark-gray: #475569;
            --border-radius: 10px;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --shadow-lg: 0 5px 15px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        [data-theme="dark"] {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --secondary: #94a3b8;
            --dark: #f1f5f9;
            --light: #0f172a;
            --gray: #1e293b;
            --dark-gray: #cbd5e1;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            transition: var(--transition);
            min-height: 100vh;
        }

        /* ========== LAYOUT ========== */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* ========== HEADER ========== */
        header {
            background: var(--light);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 1rem 0;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }

        .logo i {
            font-size: 1.8rem;
        }

        .nav-links {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* ========== BUTTONS ========== */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: var(--border-radius);
            font-family: 'Cairo', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--gray);
            color: var(--dark);
        }

        .btn-secondary:hover {
            background: var(--dark-gray);
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            padding: 0;
            justify-content: center;
            border-radius: 50%;
            background: var(--gray);
            color: var(--dark);
            font-size: 1.2rem;
        }

        .btn-icon:hover {
            background: var(--dark-gray);
        }

        /* ========== HERO SECTION ========== */
        .hero {
            padding: 3rem 0;
            text-align: center;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-radius: var(--border-radius);
            margin: 2rem 0;
        }

        .hero h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto 1.5rem;
            opacity: 0.9;
        }

        /* ========== ARTICLES GRID ========== */
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 2rem 0 1rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .articles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .article-card {
            background: var(--light);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid var(--gray);
            cursor: pointer;
        }

        .article-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .article-image {
            width: 100%;
            height: 180px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            overflow: hidden;
        }

        .article-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .article-content {
            padding: 1.2rem;
        }

        .article-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark);
            line-height: 1.4;
        }

        .article-excerpt {
            color: var(--secondary);
            margin-bottom: 0.8rem;
            line-height: 1.5;
            font-size: 0.9rem;
        }

        .article-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 0.8rem;
            padding-top: 0.8rem;
            border-top: 1px solid var(--gray);
            font-size: 0.8rem;
            color: var(--secondary);
        }

        .article-tags {
            display: flex;
            gap: 0.4rem;
            flex-wrap: wrap;
        }

        .tag {
            background: var(--gray);
            color: var(--primary);
            padding: 0.2rem 0.6rem;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        /* ========== MODALS ========== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--light);
            border-radius: var(--border-radius);
            padding: 2rem;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: var(--shadow-lg);
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--secondary);
        }

        .modal-close:hover {
            color: var(--danger);
        }

        /* ========== FORMS ========== */
        .form-group {
            margin-bottom: 1.2rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.4rem;
            font-weight: 600;
            color: var(--dark);
            font-size: 0.9rem;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--gray);
            border-radius: var(--border-radius);
            font-family: 'Cairo', sans-serif;
            font-size: 0.9rem;
            background: var(--light);
            color: var(--dark);
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* ========== LOADING & STATES ========== */
        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--secondary);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--gray);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--secondary);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--gray);
        }

        /* ========== NOTIFICATIONS ========== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: var(--shadow-lg);
            z-index: 3000;
            animation: slideIn 0.3s ease;
            max-width: 400px;
        }

        .notification.success {
            background: var(--success);
            color: white;
        }

        .notification.error {
            background: var(--danger);
            color: white;
        }

        .notification.info {
            background: var(--primary);
            color: white;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        /* ========== RESPONSIVE ========== */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .hero h1 {
                font-size: 1.5rem;
            }
            
            .articles-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                padding: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .btn {
                padding: 0.5rem 1rem;
                font-size: 0.8rem;
            }
            
            .section-title {
                font-size: 1.2rem;
            }
            
            .hero {
                padding: 2rem 1rem;
            }
        }

        /* ========== UTILITY CLASSES ========== */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }

        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }
    </style>
</head>
<body data-theme="light">
    <!-- ========== HEADER ========== -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-stethoscope"></i>
                    <span>MedUpdates</span>
                </div>
                
                <div class="nav-links">
                    <button class="btn btn-icon" id="themeToggle" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹">
                        <i class="fas fa-moon"></i>
                    </button>
                    
                    <button class="btn btn-primary" id="loginBtn">
                        <i class="fas fa-sign-in-alt"></i>
                        ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- ========== HERO SECTION ========== -->
    <section class="hero">
        <div class="container">
            <h1><i class="fas fa-heartbeat"></i> Ù…Ù†ØµØ© Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø·Ø¨ÙŠØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</h1>
            <p>Ø£Ø­Ø¯Ø« Ø§Ù„Ø£Ø¨Ø­Ø§Ø« ÙˆØ§Ù„ØªØ·ÙˆØ±Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ© Ù…Ù† Ø­ÙˆÙ„ Ø§Ù„Ø¹Ø§Ù„Ù…ØŒ Ù…Ù‚Ø¯Ù…Ø© Ø¨Ù„ØºØªÙ†Ø§ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¨ÙƒÙ„ Ø¯Ù‚Ø© ÙˆÙ…ÙˆØ«ÙˆÙ‚ÙŠØ©</p>
            <button class="btn btn-primary" id="addFirstArticleBtn">
                <i class="fas fa-plus"></i>
                Ø£Ø¶Ù Ù…Ù‚Ø§Ù„ØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰
            </button>
        </div>
    </section>

    <!-- ========== MAIN CONTENT ========== -->
    <main class="container">
        <h2 class="section-title">
            <i class="fas fa-newspaper"></i>
            Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª
        </h2>
        
        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª...</p>
        </div>
        
        <div id="articlesGrid" class="articles-grid"></div>
        
        <div id="noArticles" class="empty-state hidden">
            <i class="fas fa-file-alt"></i>
            <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‚Ø§Ù„Ø§Øª Ø¨Ø¹Ø¯</h3>
            <p>ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠØ¶ÙŠÙ Ù…Ø­ØªÙˆÙ‰ Ø·Ø¨ÙŠ Ù…ÙÙŠØ¯</p>
            <button class="btn btn-primary mt-2" id="addArticleEmptyBtn">
                <i class="fas fa-plus"></i>
                Ø£Ø¶Ù Ø£ÙˆÙ„ Ù…Ù‚Ø§Ù„Ø©
            </button>
        </div>
    </main>

    <!-- ========== LOGIN MODAL ========== -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" id="closeLoginModal">&times;</button>
            <h2 class="mb-3">
                <i class="fas fa-user-shield"></i>
                ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            </h2>
            
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</label>
                    <input type="email" id="loginEmail" class="form-control" 
                           placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                    <input type="password" id="loginPassword" class="form-control" 
                           placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
                </div>
                
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <i class="fas fa-sign-in-alt"></i>
                    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                </button>
            </form>
            
            <div class="mt-3 pt-3" style="border-top: 1px solid var(--gray);">
                <p style="color: var(--secondary); text-align: center; font-size: 0.9rem;">
                    Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ù„Ø°ÙŠÙ† Ø£Ø¶ÙØªÙ‡Ù…Ø§ ÙÙŠ Firebase Console
                </p>
            </div>
        </div>
    </div>

    <!-- ========== ADMIN PANEL MODAL ========== -->
    <div id="adminPanel" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <button class="modal-close" id="closeAdminPanel">&times;</button>
            
            <h2 class="mb-3">
                <i class="fas fa-tachometer-alt"></i>
                Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
            </h2>
            
            <form id="addArticleForm">
                <div class="form-group">
                    <label class="form-label">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‚Ø§Ù„Ø©:</label>
                    <input type="text" id="articleTitle" class="form-control" 
                           placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‚Ø§Ù„Ø©" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù‚Ø§Ù„Ø©:</label>
                    <textarea id="articleContent" class="form-control form-textarea" 
                              placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ù‚Ø§Ù„Ø©" required></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ø§Ù„ÙˆØ³ÙˆÙ… (Ù…ÙØµÙˆÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„):</label>
                    <input type="text" id="articleTags" class="form-control" 
                           placeholder="Ù…Ø«Ø§Ù„: ØªØºØ°ÙŠØ©ØŒ ØµØ­Ø©ØŒ Ø£Ø¨Ø­Ø§Ø«">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
                    <input type="url" id="articleImage" class="form-control" 
                           placeholder="https://example.com/image.jpg">
                </div>
                
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="articleFeatured">
                        <span>Ù…Ù‚Ø§Ù„Ø© Ù…Ù…ÙŠØ²Ø©</span>
                    </label>
                </div>
                
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <i class="fas fa-paper-plane"></i>
                    Ù†Ø´Ø± Ø§Ù„Ù…Ù‚Ø§Ù„Ø©
                </button>
            </form>
            
            <div class="mt-4 pt-3" style="border-top: 1px solid var(--gray);">
                <h3 class="mb-2">
                    <i class="fas fa-list"></i>
                    Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø©
                </h3>
                <div id="articlesList" style="max-height: 300px; overflow-y: auto;"></div>
            </div>
        </div>
    </div>

    <!-- ========== ARTICLE DETAIL MODAL ========== -->
    <div id="articleDetailModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <button class="modal-close" id="closeArticleDetail">&times;</button>
            <div id="articleDetailContent"></div>
        </div>
    </div>

    <!-- ========== FIREBASE & APP JS ========== -->
    <script type="module">
        // ========== FIREBASE CONFIGURATION ==========
        const firebaseConfig = {
            apiKey: "AIzaSyAw9t5IC4JAWcjx5uZsCG8xbN_TE7AA664",
            authDomain: "medupdates-decb5.firebaseapp.com",
            projectId: "medupdates-decb5",
            storageBucket: "medupdates-decb5.firebasestorage.app",
            messagingSenderId: "822964222028",
            appId: "1:822964222028:web:b2867a580d21b727a89ce9",
            measurementId: "G-41KW7Z552B"
        };

        // ========== FIREBASE INITIALIZATION ==========
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { 
            getFirestore, collection, addDoc, getDocs, deleteDoc, doc, 
            query, orderBy, serverTimestamp 
        } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";
        import { 
            getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged 
        } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        console.log("âœ… Firebase Ù…ØªØµÙ„ Ø¨Ù†Ø¬Ø§Ø­!");

        // ========== STATE MANAGEMENT ==========
        let currentUser = null;
        let articles = [];

        // ========== THEME MANAGEMENT ==========
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.body.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);
        }

        function toggleTheme() {
            const currentTheme = document.body.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            document.body.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        }

        function updateThemeIcon(theme) {
            const icon = document.querySelector('#themeToggle i');
            icon.className = theme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
            document.getElementById('themeToggle').title = 
                theme === 'light' ? 'ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¸Ù„Ù…' : 'ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­';
        }

        // ========== AUTHENTICATION ==========
        function initAuth() {
            onAuthStateChanged(auth, (user) => {
                currentUser = user;
                updateAuthUI();
                
                if (user) {
                    console.log("ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„:", user.email);
                    showNotification(Ù…Ø±Ø­Ø¨Ø§Ù‹ ${user.email}, 'success');
                }
            });
        }

        async function login(email, password) {
            try {
                await signInWithEmailAndPassword(auth, email, password);
                return true;
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:', error);
                showNotification('Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ' + error.message, 'error');
                return false;
            }
        }

        async function logout() {
            try {
                await signOut(auth);
                showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', 'success');
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬:', error);
                showNotification('Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', 'error');
            }
        }

        function updateAuthUI() {
            const loginBtn = document.getElementById('loginBtn');
            
            if (currentUser) {
                loginBtn.innerHTML = '<i class="fas fa-sign-out-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬';
                loginBtn.onclick = logout;
            } else {
                loginBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
                loginBtn.onclick = () => openModal('loginModal');
            }
        }

        // ========== ARTICLES MANAGEMENT ==========
        async function fetchArticles() {
            showLoading(true);
            
            try {
                const q = query(collection(db, "articles"), orderBy("timestamp", "desc"));
                const querySnapshot = await getDocs(q);
                
                articles = [];
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    articles.push({
                        id: doc.id,
                        title: data.title || 'Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†',
                        content: data.content || '',
                        tags: data.tags || [],
                        image: data.image || null,
                        featured: data.featured || false,
                        timestamp: data.timestamp?.toDate() || new Date(),
                        author: data.authorEmail || 'Ù…Ø³ØªØ®Ø¯Ù…'
                    });
                });
                
                displayArticles();
                console.log(ğŸ“Š ØªÙ… ØªØ­Ù…ÙŠÙ„ ${articles.length} Ù…Ù‚Ø§Ù„Ø©);
                
            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª:", error);
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª', 'error');
            } finally {
                showLoading(false);
            }
        }

        function displayArticles() {
            const grid = document.getElementById('articlesGrid');
            const noArticles = document.getElementById('noArticles');
            
            if (articles.length === 0) {
                grid.innerHTML = '';
                noArticles.classList.remove('hidden');
                return;
            }
            
            noArticles.classList.add('hidden');
            
            grid.innerHTML = articles.map(article => `
                <div class="article-card" data-id="${article.id}">
                    <div class="article-image">
                        ${article.image ? 
                            <img src="${article.image}" alt="${article.title}" loading="lazy"> : 
                            <i class="fas fa-file-medical-alt"></i>
                        }
                    </div>
                    <div class="article-content">
                        ${article.featured ? 
                            '<span class="tag" style="background: var(--warning); color: white; margin-bottom: 8px;">â­ Ù…Ù…ÙŠØ²</span>' : 
                            ''
                        }
                        <h3 class="article-title">${article.title}</h3>
                        <p class="article-excerpt">${article.content.substring(0, 120)}...</p>
                        <div class="article-meta">
                            <div class="article-tags">
                                ${article.tags.map(tag => <span class="tag">${tag}</span>).join('')}
                            </div>
                            <span>${formatDate(article.timestamp)}</span>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Add click events to article cards
            document.querySelectorAll('.article-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    if (!e.target.closest('.delete-btn')) {
                        const articleId = card.getAttribute('data-id');
                        showArticleDetail(articleId);
                    }
                });
            });
        }

        async function addArticle(articleData) {
            if (!currentUser) {
                showNotification('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return false;
            }

            try {
                const article = {
                    title: articleData.title,
                    content: articleData.content,
                    tags: articleData.tags,
                    image: articleData.image || null,
                    featured: articleData.featured || false,
                    timestamp: serverTimestamp(),
                    authorEmail: currentUser.email,
                    createdAt: new Date().toISOString()
                };

                await addDoc(collection(db, "articles"), article);
                
                showNotification('âœ… ØªÙ… Ù†Ø´Ø± Ø§Ù„Ù…Ù‚Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                fetchArticles();
                
                return true;
            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‚Ø§Ù„Ø©:", error);
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‚Ø§Ù„Ø©', 'error');
                return false;
            }
        }

        async function deleteArticle(articleId) {
            if (!currentUser) {
                showNotification('ØºÙŠØ± Ù…ØµØ±Ø­', 'error');
                return;
            }

            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‚Ø§Ù„Ø©ØŸ')) {
                return;
            }

            try {
                await deleteDoc(doc(db, "articles", articleId));
                showNotification('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø§Ù„Ø©', 'success');
                fetchArticles();
                closeModal('articleDetailModal');
            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø§Ù„Ø©:", error);
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø§Ù„Ø©', 'error');
            }
        }

        function showArticleDetail(articleId) {
            const article = articles.find(a => a.id === articleId);
            if (!article) return;

            const content = document.getElementById('articleDetailContent');
            content.innerHTML = `
                <article>
                    ${article.image ? 
                        `<img src="${article.image}" alt="${article.title}" 
                              style="width:100%; border-radius:var(--border-radius); margin-bottom:1.5rem;">` : 
                        ''
                    }
                    
                    <h1 style="font-size: 1.8rem; margin-bottom: 1rem; color: var(--primary);">
                        ${article.title}
                    </h1>
                    
                    <div style="display:flex; gap:1rem; margin-bottom:1.5rem; color:var(--secondary); font-size:0.9rem;">
                        <span><i class="far fa-calendar"></i> ${formatDate(article.timestamp)}</span>
                        <span><i class="far fa-user"></i> ${article.author}</span>
                    </div>
                    
                    <div class="article-tags" style="margin-bottom: 1.5rem;">
                        ${article.tags.map(tag => <span class="tag">${tag}</span>).join('')}
                    </div>
                    
                    <div style="font-size: 1rem; line-height: 1.8; margin-bottom: 2rem;">
                        ${article.content.replace(/\n/g, '<br>')}
                    </div>
                    
                    <div style="display: flex; gap: 1rem; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--gray);">
                        ${currentUser ? 
                            `<button class="btn btn-secondary delete-btn" onclick="window.deleteArticle('${articleId}')">
                                <i class="fas fa-trash"></i> Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø§Ù„Ø©
                            </button>` : 
                            ''
                        }
                        <button class="btn btn-secondary" onclick="closeModal('articleDetailModal')">
                            <i class="fas fa-times"></i> Ø¥ØºÙ„Ø§Ù‚
                        </button>
                    </div>
                </article>
            `;
            
            openModal('articleDetailModal');
        }

        function renderArticlesList() {
            const listDiv = document.getElementById('articlesList');
            
            if (articles.length === 0) {
                listDiv.innerHTML = '<p style="color: var(--secondary); text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‚Ø§Ù„Ø§Øª</p>';
                return;
            }
            
            listDiv.innerHTML = articles.map(article => `
                <div style="padding: 0.8rem; border-bottom: 1px solid var(--gray); display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <strong>${article.title}</strong>
                        <div style="font-size: 0.8rem; color: var(--secondary);">
                            ${formatDate(article.timestamp)}
                        </div>
                    </div>
                    <button class="btn btn-secondary" style="padding: 0.3rem 0.6rem; font-size: 0.8rem;" 
                            onclick="window.deleteArticle('${article.id}')">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `).join('');
        }

        // ========== UI UTILITIES ==========
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
            document.body.style.overflow = 'hidden';
            
            if (modalId === 'adminPanel') {
                renderArticlesList();
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        function showNotification(message, type = 'info') {
            // Remove existing notifications
            document.querySelectorAll('.notification').forEach(n => n.remove());
            
            const notification = document.createElement('div');
            notification.className = notification ${type};
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }
            }, 5000);
        }

        function formatDate(date) {
            if (!date) return '';
            const d = new Date(date);
            return d.toLocaleDateString('ar-EG', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        // ========== FORM HANDLERS ==========
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const success = await login(email, password);
            if (success) {
                closeModal('loginModal');
                document.getElementById('loginForm').reset();
                openModal('adminPanel');
            }
        });

        document.getElementById('addArticleForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (!currentUser) {
                showNotification('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }
            
            const articleData = {
                title: document.getElementById('articleTitle').value.trim(),
                content: document.getElementById('articleContent').value.trim(),
                tags: document.getElementById('articleTags').value.split(',')
                    .map(t => t.trim())
                    .filter(t => t),
                image: document.getElementById('articleImage').value.trim() || null,
                featured: document.getElementById('articleFeatured').checked
            };
            
            const success = await addArticle(articleData);
            if (success) {
                e.target.reset();
                closeModal('adminPanel');
            }
        });

        // ========== EVENT LISTENERS ==========
        document.getElementById('themeToggle').addEventListener('click', toggleTheme);
        
        document.getElementById('addFirstArticleBtn').addEventListener('click', () => {
            if (currentUser) {
                openModal('adminPanel');
            } else {
                openModal('loginModal');
            }
        });
        
        document.getElementById('addArticleEmptyBtn').addEventListener('click', () => {
            if (currentUser) {
                openModal('adminPanel');
            } else {
                openModal('loginModal');
            }
        });
        
        document.getElementById('closeLoginModal').addEventListener('click', () => closeModal('loginModal'));
        document.getElementById('closeAdminPanel').addEventListener('click', () => closeModal('adminPanel'));
        document.getElementById('closeArticleDetail').addEventListener('click', () => closeModal('articleDetailModal'));

        // Close modals when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal(modal.id);
                }
            });
        });

        // ========== GLOBAL FUNCTIONS ==========
        window.deleteArticle = deleteArticle;
        window.closeModal = closeModal;

        // ========== INITIALIZATION ==========
        function initApp() {
            initTheme();
            initAuth();
            fetchArticles();
            
            console.log("ğŸš€ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¬Ø§Ù‡Ø²!");
        }

        // Start the app
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
